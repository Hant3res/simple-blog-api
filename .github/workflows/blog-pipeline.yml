name: ğŸš€ Blog API Pipeline

on:
  push:
    branches: [main]

env:
  DOTNET_VERSION: '8.0.x'

jobs:
  test:
    name: ğŸ§ª Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
    runs-on: ubuntu-latest

    steps:
    - name: ğŸ’¬ Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµĞ¼ ĞºĞ¾Ğ´
      uses: actions/checkout@v4

    - name: ğŸ’¬ Ğ£ÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµĞ¼ .NET
      uses: actions/setup-dotnet@v3
      with:
        dotnet-version: ${{ env.DOTNET_VERSION }}

    - name: ğŸ’¬ Ğ’Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸
      run: dotnet restore

    - name: ğŸ”¨ Ğ¡Ğ¾Ğ±Ğ¸Ñ€Ğ°ĞµĞ¼ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚
      run: |
        echo "=== Ğ¡Ğ‘ĞĞ ĞšĞ ĞŸĞ ĞĞ•ĞšĞ¢Ğ ==="
        dotnet build --verbosity minimal
        
    - name: ğŸ§ª Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ Ñ‚ĞµÑÑ‚Ñ‹
      run: |
        echo "=== Ğ—ĞĞŸĞ£Ğ¡Ğš Ğ¢Ğ•Ğ¡Ğ¢ĞĞ’ ==="
        cd tests/SimpleBlog.API.Tests
        dotnet test --verbosity minimal
        
    - name: ğŸ“Š ĞÑ‚Ñ‡ĞµÑ‚
      if: always()
      run: |
        echo "=== ĞĞ¢Ğ§Ğ•Ğ¢ ==="
        echo "âœ… ĞŸĞ°Ğ¹Ğ¿Ğ»Ğ°Ğ¹Ğ½ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½"
        echo "ğŸ•’ Ğ’Ñ€ĞµĞ¼Ñ: $(date)"
